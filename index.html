<!DOCTYPE html><html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Image Compressor â€“ Created by Animesh</title>
<style>
    body { margin:0; font-family: Arial, sans-serif; background:#000; color:#fff; overflow-x:hidden; }.bg-anim {
    position: fixed; top:0; left:0; width:100%; height:100%;
    background: radial-gradient(circle at top left,#ff3cac,#562b7c,#2b86c5);
    background-size: 200% 200%;
    animation: glow 8s infinite alternate;
    z-index: -1;
}
@keyframes glow { to { background-position: 100% 100%; } }

.container {
    width: 90%; max-width:900px;
    margin:40px auto;
    background: rgba(0,0,0,0.55);
    backdrop-filter: blur(12px);
    padding:25px;
    border-radius:18px;
    box-shadow:0 0 25px rgba(255,255,255,0.2);
}

.drop-zone {
    width: 140px;
    height: 70px;
    margin:auto;
    border:2px dashed #FF66CC;
    border-radius:12px;
    display:flex; align-items:center; justify-content:center;
    background: rgba(255,255,255,0.06);
    font-size:12px;
    margin-bottom:20px;
}

.btn {
    background: linear-gradient(45deg,#ff3cac,#784ba0,#2b86c5);
    padding:10px 18px;
    border:none;
    border-radius:8px;
    cursor:pointer;
    color:white;
    margin:6px;
    font-size:14px;
}

.credit { text-align:center; margin-top:20px; font-family:"Brush Script MT", cursive; font-size:18px; opacity:0.8; }

.preview-img { max-width:100%; border-radius:12px; margin-top:10px; }

.result-box {
    background: rgba(255,255,255,0.08);
    padding:15px;
    border-radius:10px;
    margin-top:20px;
}

</style>
</head>
<body>
<div class="bg-anim"></div>
<div class="container">
<h2>Image Compressor</h2><div id="dropZone" class="drop-zone">Drag Files</div>
<input id="fileInput" type="file" accept="image/*" style="display:none;" />
<button class="btn" onclick="document.getElementById('fileInput').click()">Upload</button>
<button class="btn" onclick="clearAll()">Clear All</button><div id="originalInfo"></div>
<div id="results"></div><div class="credit">Created by Animesh</div>
</div><script>
let selectedFile = null;

// Utility: Convert DataURL to Blob
function dataURLtoBlob(dataURL) {
    const byteString = atob(dataURL.split(',')[1]);
    const mimeString = dataURL.split(',')[0].split(':')[1].split(';')[0];
    const ab = new ArrayBuffer(byteString.length);
    const ia = new Uint8Array(ab);
    for (let i = 0; i < byteString.length; i++) ia[i] = byteString.charCodeAt(i);
    return new Blob([ab], { type: mimeString });
}

// Drag events
const dropZone = document.getElementById("dropZone");
dropZone.addEventListener("dragover", (e)=>{ e.preventDefault(); dropZone.style.borderColor="#fff"; });
dropZone.addEventListener("dragleave", ()=>{ dropZone.style.borderColor="#FF66CC"; });
dropZone.addEventListener("drop", (e)=>{
    e.preventDefault();
    selectedFile = e.dataTransfer.files[0];
    processFile();
});

document.getElementById("fileInput").addEventListener("change", function(){
    selectedFile = this.files[0];
    processFile();
});

function clearAll(){
    selectedFile = null;
    document.getElementById("originalInfo").innerHTML="";
    document.getElementById("results").innerHTML="";
}

function formatSize(bytes) {
    const kb = (bytes/1024).toFixed(2);
    const mb = (bytes/1024/1024).toFixed(2);
    return `${kb} KB (${mb} MB)`;
}

function processFile(){
    if(!selectedFile) return;

    const img = new Image();
    const reader = new FileReader();
    reader.onload = (e)=>{ img.src = e.target.result; };
    reader.readAsDataURL(selectedFile);

    img.onload = ()=>{
        const origW = img.width;
        const origH = img.height;
        const origBytes = selectedFile.size;
        const ext = selectedFile.name.split('.').pop().toLowerCase();

        document.getElementById("originalInfo").innerHTML = `
            <h3>Original Image</h3>
            <img src="${img.src}" class="preview-img">
            <p><b>Format:</b> ${ext}</p>
            <p><b>Resolution:</b> ${origW} x ${origH}</p>
            <p><b>Size:</b> ${formatSize(origBytes)}</p>
        `;

        generateReduced(img, ext, origBytes, origW, origH);
    }
}

function generateReduced(img, ext, origBytes, origW, origH){
    const canvas = document.createElement("canvas");

    const newW = Math.floor(origW * 0.50);
    const newH = Math.floor(origH * 0.50);

    canvas.width = newW;
    canvas.height = newH;
    const ctx = canvas.getContext("2d");
    ctx.drawImage(img, 0,0,newW,newH);

    let quality = 0.8;
    let reducedBlob = null;
    let reducedBytes = Infinity;
    let dataURL;

    while (quality > 0.1) {
        dataURL = canvas.toDataURL(`image/${ext}`, quality);
        reducedBlob = dataURLtoBlob(dataURL);
        reducedBytes = reducedBlob.size;

        if (reducedBytes < origBytes * 0.98) break; // ensure reduction
        quality -= 0.1;
    }

    if (reducedBytes >= origBytes) {
        document.getElementById("results").innerHTML = `
            <div class='result-box'>
                <h3>Compression Failed</h3>
                <p>The compressed image became larger. No output is generated.</p>
            </div>
        `;
        return;
    }

    const percent = (((origBytes - reducedBytes)/origBytes) * 100).toFixed(1);

    document.getElementById("results").innerHTML = `
        <div class='result-box'>
            <h3>Reduced Output</h3>
            <img class='preview-img' src='${dataURL}' />
            <p><b>Format:</b> ${ext}</p>
            <p><b>Resolution:</b> ${newW} x ${newH}</p>
            <p><b>Size:</b> ${formatSize(reducedBytes)}</p>
            <p><b>Reduced By:</b> ${percent}%</p>
            <a class='btn' download='reduced.${ext}' href='${dataURL}'>Download</a>
        </div>
    `;
}
</script></body>
</html>
